SELECT date(ts) AS date,
       strftime('%Y-%m-%d %H', ts) AS hour,
       COUNT(DISTINCT COALESCE(id, 0)) AS cnt_id,
       MAX(ts) AS max_ts,
       COUNT(DISTINCT COALESCE(event_type, 0)) AS cnt_event_type,
       COUNT(DISTINCT COALESCE(ua, 0)) AS cnt_ua,
       COUNT(DISTINCT COALESCE(dnt, 0)) AS cnt_dnt,
       COUNT(DISTINCT COALESCE(charge, 0)) AS cnt_charge,
       COUNT(DISTINCT COALESCE(payment, 0)) AS cnt_payment,
       MAX(modified) AS max_modified
FROM events_clone
WHERE date(ts) = '2018-01-01'
GROUP BY 1,2
ORDER BY 1,2